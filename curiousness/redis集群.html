<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>config | kikfan</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css">
    <meta name="description" content="kikfan">
    
    <link rel="preload" href="/assets/css/2.styles.051e8285.css" as="style"><link rel="preload" href="/assets/js/app.27b2d4ce.js" as="script"><link rel="preload" href="/assets/js/4.9a9f6078.js" as="script"><link rel="preload" href="/assets/js/54.2c4f1849.js" as="script"><link rel="prefetch" href="/assets/js/0.e4e7bdd7.js"><link rel="prefetch" href="/assets/js/1.fa961c29.js"><link rel="prefetch" href="/assets/js/10.731ee775.js"><link rel="prefetch" href="/assets/js/100.8f4b7cc5.js"><link rel="prefetch" href="/assets/js/101.a083f158.js"><link rel="prefetch" href="/assets/js/102.2c3648c3.js"><link rel="prefetch" href="/assets/js/103.f00d7dd8.js"><link rel="prefetch" href="/assets/js/104.0c414ab7.js"><link rel="prefetch" href="/assets/js/105.683675df.js"><link rel="prefetch" href="/assets/js/106.733b71a1.js"><link rel="prefetch" href="/assets/js/107.16837d98.js"><link rel="prefetch" href="/assets/js/108.28ae623b.js"><link rel="prefetch" href="/assets/js/109.a702f251.js"><link rel="prefetch" href="/assets/js/11.d7b558c8.js"><link rel="prefetch" href="/assets/js/110.74980c24.js"><link rel="prefetch" href="/assets/js/111.bf05772f.js"><link rel="prefetch" href="/assets/js/112.7f823ce5.js"><link rel="prefetch" href="/assets/js/113.4145bf66.js"><link rel="prefetch" href="/assets/js/114.4466ba9a.js"><link rel="prefetch" href="/assets/js/115.7066e3ba.js"><link rel="prefetch" href="/assets/js/116.dc1f78b7.js"><link rel="prefetch" href="/assets/js/117.88fe74db.js"><link rel="prefetch" href="/assets/js/118.e37e03b4.js"><link rel="prefetch" href="/assets/js/119.d7e4f790.js"><link rel="prefetch" href="/assets/js/12.42f2fa87.js"><link rel="prefetch" href="/assets/js/13.41e1d4b5.js"><link rel="prefetch" href="/assets/js/14.5b7e8e37.js"><link rel="prefetch" href="/assets/js/15.d9e0fc06.js"><link rel="prefetch" href="/assets/js/16.87dd9a3b.js"><link rel="prefetch" href="/assets/js/17.d120ed17.js"><link rel="prefetch" href="/assets/js/18.59184376.js"><link rel="prefetch" href="/assets/js/19.39139a03.js"><link rel="prefetch" href="/assets/js/20.2d9ec408.js"><link rel="prefetch" href="/assets/js/21.6e654bc3.js"><link rel="prefetch" href="/assets/js/22.1a060135.js"><link rel="prefetch" href="/assets/js/23.dcf0bfcc.js"><link rel="prefetch" href="/assets/js/24.9b4a4b3e.js"><link rel="prefetch" href="/assets/js/25.f57f3c65.js"><link rel="prefetch" href="/assets/js/26.fc43a3ae.js"><link rel="prefetch" href="/assets/js/27.e9aaf732.js"><link rel="prefetch" href="/assets/js/28.6e1886c7.js"><link rel="prefetch" href="/assets/js/29.ff720b7d.js"><link rel="prefetch" href="/assets/js/30.297554f4.js"><link rel="prefetch" href="/assets/js/31.fc02f056.js"><link rel="prefetch" href="/assets/js/32.978c9766.js"><link rel="prefetch" href="/assets/js/33.faa483ef.js"><link rel="prefetch" href="/assets/js/34.7f3cc871.js"><link rel="prefetch" href="/assets/js/35.62b9a752.js"><link rel="prefetch" href="/assets/js/36.c08848fc.js"><link rel="prefetch" href="/assets/js/37.59f685b7.js"><link rel="prefetch" href="/assets/js/38.c1588f41.js"><link rel="prefetch" href="/assets/js/39.fdb35fe6.js"><link rel="prefetch" href="/assets/js/40.65505803.js"><link rel="prefetch" href="/assets/js/41.54da323c.js"><link rel="prefetch" href="/assets/js/42.45bbba91.js"><link rel="prefetch" href="/assets/js/43.1f36637d.js"><link rel="prefetch" href="/assets/js/44.d7d8a539.js"><link rel="prefetch" href="/assets/js/45.7d764f0b.js"><link rel="prefetch" href="/assets/js/46.3bad6567.js"><link rel="prefetch" href="/assets/js/47.2946a535.js"><link rel="prefetch" href="/assets/js/48.85cbb854.js"><link rel="prefetch" href="/assets/js/49.315a2781.js"><link rel="prefetch" href="/assets/js/5.60a71eda.js"><link rel="prefetch" href="/assets/js/50.58a11a9c.js"><link rel="prefetch" href="/assets/js/51.ea33dd6c.js"><link rel="prefetch" href="/assets/js/52.c9f47820.js"><link rel="prefetch" href="/assets/js/53.012a446d.js"><link rel="prefetch" href="/assets/js/55.2a967be9.js"><link rel="prefetch" href="/assets/js/56.2d46c0a0.js"><link rel="prefetch" href="/assets/js/57.c8880e0a.js"><link rel="prefetch" href="/assets/js/58.a6b007f9.js"><link rel="prefetch" href="/assets/js/59.97b9b7e5.js"><link rel="prefetch" href="/assets/js/6.afcd84ec.js"><link rel="prefetch" href="/assets/js/60.f4a784fc.js"><link rel="prefetch" href="/assets/js/61.05eed8fc.js"><link rel="prefetch" href="/assets/js/62.d95be5f8.js"><link rel="prefetch" href="/assets/js/63.c0d0a152.js"><link rel="prefetch" href="/assets/js/64.f74c6626.js"><link rel="prefetch" href="/assets/js/65.4872ba36.js"><link rel="prefetch" href="/assets/js/66.3846d75c.js"><link rel="prefetch" href="/assets/js/67.5d3c513c.js"><link rel="prefetch" href="/assets/js/68.4c28dad7.js"><link rel="prefetch" href="/assets/js/69.23fa6377.js"><link rel="prefetch" href="/assets/js/7.69deb300.js"><link rel="prefetch" href="/assets/js/70.a1673575.js"><link rel="prefetch" href="/assets/js/71.53175f3c.js"><link rel="prefetch" href="/assets/js/72.699361e6.js"><link rel="prefetch" href="/assets/js/73.683bacf8.js"><link rel="prefetch" href="/assets/js/74.d27b950a.js"><link rel="prefetch" href="/assets/js/75.30cfcf8c.js"><link rel="prefetch" href="/assets/js/76.7115ba1f.js"><link rel="prefetch" href="/assets/js/77.61f7aec4.js"><link rel="prefetch" href="/assets/js/78.d9b71b38.js"><link rel="prefetch" href="/assets/js/79.8df96305.js"><link rel="prefetch" href="/assets/js/8.b5d41094.js"><link rel="prefetch" href="/assets/js/80.caefa481.js"><link rel="prefetch" href="/assets/js/81.fbe7f1af.js"><link rel="prefetch" href="/assets/js/82.8a0c0e86.js"><link rel="prefetch" href="/assets/js/83.77f553eb.js"><link rel="prefetch" href="/assets/js/84.9d3058ad.js"><link rel="prefetch" href="/assets/js/85.d66493d7.js"><link rel="prefetch" href="/assets/js/86.d82b3465.js"><link rel="prefetch" href="/assets/js/87.ff69dfdc.js"><link rel="prefetch" href="/assets/js/88.db8a809d.js"><link rel="prefetch" href="/assets/js/89.dbae01c0.js"><link rel="prefetch" href="/assets/js/9.42dfa068.js"><link rel="prefetch" href="/assets/js/90.ac501b95.js"><link rel="prefetch" href="/assets/js/91.de4c7a0e.js"><link rel="prefetch" href="/assets/js/92.689f4272.js"><link rel="prefetch" href="/assets/js/93.17e1c4ae.js"><link rel="prefetch" href="/assets/js/94.1978b8c9.js"><link rel="prefetch" href="/assets/js/95.fb0afeb1.js"><link rel="prefetch" href="/assets/js/96.8b6541d8.js"><link rel="prefetch" href="/assets/js/97.793aa5c6.js"><link rel="prefetch" href="/assets/js/98.62b7c58e.js"><link rel="prefetch" href="/assets/js/99.54020815.js">
    <link rel="stylesheet" href="/assets/css/2.styles.051e8285.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">kikfan</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/idea/" class="nav-link">
  IDEA
</a></div><div class="nav-item"><a href="/devops/" class="nav-link">
  DevOps
</a></div><div class="nav-item"><a href="/web/" class="nav-link">
  Web
</a></div><div class="nav-item"><a href="/curiousness/" class="nav-link router-link-active">
  好奇尚异
</a></div><div class="nav-item"><a href="/long-road/" class="nav-link">
  道阻且长
</a></div><div class="nav-item"><a href="/step-back/" class="nav-link">
  海阔天空
</a></div><div class="nav-item"><a href="/experience/" class="nav-link">
  吃堑长智
</a></div><div class="nav-item"><a href="/tools/" class="nav-link">
  Tools
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/idea/" class="nav-link">
  IDEA
</a></div><div class="nav-item"><a href="/devops/" class="nav-link">
  DevOps
</a></div><div class="nav-item"><a href="/web/" class="nav-link">
  Web
</a></div><div class="nav-item"><a href="/curiousness/" class="nav-link router-link-active">
  好奇尚异
</a></div><div class="nav-item"><a href="/long-road/" class="nav-link">
  道阻且长
</a></div><div class="nav-item"><a href="/step-back/" class="nav-link">
  海阔天空
</a></div><div class="nav-item"><a href="/experience/" class="nav-link">
  吃堑长智
</a></div><div class="nav-item"><a href="/tools/" class="nav-link">
  Tools
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>好奇尚异</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/curiousness/" aria-current="page" class="sidebar-link">简介</a></li><li><a href="/curiousness/Elasticsearch.html" class="sidebar-link">Elasticsearch</a></li><li><a href="/curiousness/IDEA插件开发小试牛刀.html" class="sidebar-link">IDEA插件开发小试牛刀</a></li><li><a href="/curiousness/Kubernates-k8s.html" class="sidebar-link">Kubernates-k8s</a></li><li><a href="/curiousness/Redis-Sentinel高可用.html" class="sidebar-link">Redis-Sentinel高可用</a></li><li><a href="/curiousness/SearchQuickByShortcut.html" class="sidebar-link">SearchQuickByShortcut</a></li><li><a href="/curiousness/bitmap-有点意思.html" class="sidebar-link">bitmap-有点意思</a></li><li><a href="/curiousness/frp实现内网穿透.html" class="sidebar-link">frp实现内网穿透</a></li><li><a href="/curiousness/harbor镜像自动清理脚本.html" class="sidebar-link">harbor镜像自动清理脚本</a></li><li><a href="/curiousness/jenkins配置及使用.html" class="sidebar-link">jenkins配置及使用</a></li><li><a href="/curiousness/openvpn-frp实现内网穿透远程办公.html" class="sidebar-link">openvpn-frp实现内网穿透远程办公</a></li><li><a href="/curiousness/openvpn的ip切换.html" class="sidebar-link">openvpn的ip切换</a></li><li><a href="/curiousness/redis配置及命令大全.html" class="sidebar-link">redis配置及命令大全</a></li><li><a href="/curiousness/redis集群.html" class="active sidebar-link">redis集群</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/curiousness/redis集群.html#config" class="sidebar-link">config</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/curiousness/redis集群.html#带注解版config" class="sidebar-link">带注解版config</a></li></ul></li><li class="sidebar-sub-header"><a href="/curiousness/redis集群.html#redis-sh" class="sidebar-link">redis.sh</a></li><li class="sidebar-sub-header"><a href="/curiousness/redis集群.html#yml" class="sidebar-link">yml</a></li><li class="sidebar-sub-header"><a href="/curiousness/redis集群.html#集群的创建" class="sidebar-link">集群的创建</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="config"><a href="#config" class="header-anchor">#</a> config</h2> <div class="language-editorconfig extra-class"><pre class="language-editorconfig"><code>port 6391

tcp-backlog 511

timeout 0

tcp-keepalive 300

supervised no

pidfile /var/run/redis_6391.pid

loglevel notice

logfile &quot;&quot;

databases 16

always-show-logo yes


save 900 1
save 300 10
save 60 10000

stop-writes-on-bgsave-error yes

rdbcompression yes

rdbchecksum yes

<span class="token comment">## The filename where to dump the DB</span>
dbfilename dump.rdb

dir &quot;/data&quot;

<span class="token comment">################################# REPLICATION #################################</span>

<span class="token comment">## Master-Replica replication. Use replicaof to make a Redis instance a copy of</span>
masterauth 123456

</code></pre></div><h3 id="带注解版config"><a href="#带注解版config" class="header-anchor">#</a> 带注解版config</h3> <div class="language-editorconfig extra-class"><pre class="language-editorconfig"><code><span class="token comment">## Redis configuration file example.</span>
<span class="token comment">##</span>
<span class="token comment">## Note that in order to read the configuration file, Redis must be</span>
<span class="token comment">## started with the file path as first argument:</span>
<span class="token comment">##</span>
<span class="token comment">## ./redis-server /path/to/redis.conf</span>

<span class="token comment">## Note on units: when memory size is needed, it is possible to specify</span>
<span class="token comment">## it in the usual form of 1k 5GB 4M and so forth:</span>
<span class="token comment">##</span>
<span class="token comment">## 1k =&gt; 1000 bytes</span>
<span class="token comment">## 1kb =&gt; 1024 bytes</span>
<span class="token comment">## 1m =&gt; 1000000 bytes</span>
<span class="token comment">## 1mb =&gt; 1024*1024 bytes</span>
<span class="token comment">## 1g =&gt; 1000000000 bytes</span>
<span class="token comment">## 1gb =&gt; 1024*1024*1024 bytes</span>
<span class="token comment">##</span>
<span class="token comment">## units are case insensitive so 1GB 1Gb 1gB are all the same.</span>

<span class="token comment">################################## INCLUDES ###################################</span>

<span class="token comment">## Include one or more other config files here.  This is useful if you</span>
<span class="token comment">## have a standard template that goes to all Redis servers but also need</span>
<span class="token comment">## to customize a few per-server settings.  Include files can include</span>
<span class="token comment">## other files, so use this wisely.</span>
<span class="token comment">##</span>
<span class="token comment">## Notice option &quot;include&quot; won't be rewritten by command &quot;CONFIG REWRITE&quot;</span>
<span class="token comment">## from admin or Redis Sentinel. Since Redis always uses the last processed</span>
<span class="token comment">## line as value of a configuration directive, you'd better put includes</span>
<span class="token comment">## at the beginning of this file to avoid overwriting config change at runtime.</span>
<span class="token comment">##</span>
<span class="token comment">## If instead you are interested in using includes to override configuration</span>
<span class="token comment">## options, it is better to use include as the last line.</span>
<span class="token comment">##</span>
<span class="token comment">## include /path/to/local.conf</span>
<span class="token comment">## include /path/to/other.conf</span>

<span class="token comment">################################## MODULES #####################################</span>

<span class="token comment">## Load modules at startup. If the server is not able to load modules</span>
<span class="token comment">## it will abort. It is possible to use multiple loadmodule directives.</span>
<span class="token comment">##</span>
<span class="token comment">## loadmodule /path/to/my_module.so</span>
<span class="token comment">## loadmodule /path/to/other_module.so</span>

<span class="token comment">################################## NETWORK #####################################</span>

<span class="token comment">## By default, if no &quot;bind&quot; configuration directive is specified, Redis listens</span>
<span class="token comment">## for connections from all the network interfaces available on the server.</span>
<span class="token comment">## It is possible to listen to just one or multiple selected interfaces using</span>
<span class="token comment">## the &quot;bind&quot; configuration directive, followed by one or more IP addresses.</span>
<span class="token comment">##</span>
<span class="token comment">## Examples:</span>
<span class="token comment">##</span>
<span class="token comment">## bind 192.168.1.100 10.0.0.1</span>
<span class="token comment">## bind 127.0.0.1 ::1</span>
<span class="token comment">##</span>
<span class="token comment">## ~~~ WARNING ~~~ If the computer running Redis is directly exposed to the</span>
<span class="token comment">## internet, binding to all the interfaces is dangerous and will expose the</span>
<span class="token comment">## instance to everybody on the internet. So by default we uncomment the</span>
<span class="token comment">## following bind directive, that will force Redis to listen only into</span>
<span class="token comment">## the IPv4 loopback interface address (this means Redis will be able to</span>
<span class="token comment">## accept connections only from clients running into the same computer it</span>
<span class="token comment">## is running).</span>
<span class="token comment">##</span>
<span class="token comment">## IF YOU ARE SURE YOU WANT YOUR INSTANCE TO LISTEN TO ALL THE INTERFACES</span>
<span class="token comment">## JUST COMMENT THE FOLLOWING LINE.</span>
<span class="token comment">## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>


<span class="token comment">## Protected mode is a layer of security protection, in order to avoid that</span>
<span class="token comment">## Redis instances left open on the internet are accessed and exploited.</span>
<span class="token comment">##</span>
<span class="token comment">## When protected mode is on and if:</span>
<span class="token comment">##</span>
<span class="token comment">## 1) The server is not binding explicitly to a set of addresses using the</span>
<span class="token comment">##    &quot;bind&quot; directive.</span>
<span class="token comment">## 2) No password is configured.</span>
<span class="token comment">##</span>
<span class="token comment">## The server only accepts connections from clients connecting from the</span>
<span class="token comment">## IPv4 and IPv6 loopback addresses 127.0.0.1 and ::1, and from Unix domain</span>
<span class="token comment">## sockets.</span>
<span class="token comment">##</span>
<span class="token comment">## By default protected mode is enabled. You should disable it only if</span>
<span class="token comment">## you are sure you want clients from other hosts to connect to Redis</span>
<span class="token comment">## even if no authentication is configured, nor a specific set of interfaces</span>
<span class="token comment">## are explicitly listed using the &quot;bind&quot; directive.</span>
protected-mode no

<span class="token comment">## Accept connections on the specified port, default is 6379 (IANA ##815344).</span>
<span class="token comment">## If port 0 is specified Redis will not listen on a TCP socket.</span>
port 6391

<span class="token comment">## TCP listen() backlog.</span>
<span class="token comment">##</span>
<span class="token comment">## In high requests-per-second environments you need an high backlog in order</span>
<span class="token comment">## to avoid slow clients connections issues. Note that the Linux kernel</span>
<span class="token comment">## will silently truncate it to the value of /proc/sys/net/core/somaxconn so</span>
<span class="token comment">## make sure to raise both the value of somaxconn and tcp_max_syn_backlog</span>
<span class="token comment">## in order to get the desired effect.</span>
tcp-backlog 511

<span class="token comment">## Unix socket.</span>
<span class="token comment">##</span>
<span class="token comment">## Specify the path for the Unix socket that will be used to listen for</span>
<span class="token comment">## incoming connections. There is no default, so Redis will not listen</span>
<span class="token comment">## on a unix socket when not specified.</span>
<span class="token comment">##</span>
<span class="token comment">## unixsocket /tmp/redis.sock</span>
<span class="token comment">## unixsocketperm 700</span>

<span class="token comment">## Close the connection after a client is idle for N seconds (0 to disable)</span>
timeout 0

<span class="token comment">## TCP keepalive.</span>
<span class="token comment">##</span>
<span class="token comment">## If non-zero, use SO_KEEPALIVE to send TCP ACKs to clients in absence</span>
<span class="token comment">## of communication. This is useful for two reasons:</span>
<span class="token comment">##</span>
<span class="token comment">## 1) Detect dead peers.</span>
<span class="token comment">## 2) Take the connection alive from the point of view of network</span>
<span class="token comment">##    equipment in the middle.</span>
<span class="token comment">##</span>
<span class="token comment">## On Linux, the specified value (in seconds) is the period used to send ACKs.</span>
<span class="token comment">## Note that to close the connection the double of the time is needed.</span>
<span class="token comment">## On other kernels the period depends on the kernel configuration.</span>
<span class="token comment">##</span>
<span class="token comment">## A reasonable value for this option is 300 seconds, which is the new</span>
<span class="token comment">## Redis default starting with Redis 3.2.1.</span>
tcp-keepalive 300

<span class="token comment">################################# GENERAL #####################################</span>

<span class="token comment">## By default Redis does not run as a daemon. Use 'yes' if you need it.</span>
<span class="token comment">## Note that Redis will write a pid file in /var/run/redis.pid when daemonized.</span>
daemonize no

<span class="token comment">## If you run Redis from upstart or systemd, Redis can interact with your</span>
<span class="token comment">## supervision tree. Options:</span>
<span class="token comment">##   supervised no      - no supervision interaction</span>
<span class="token comment">##   supervised upstart - signal upstart by putting Redis into SIGSTOP mode</span>
<span class="token comment">##   supervised systemd - signal systemd by writing READY=1 to $NOTIFY_SOCKET</span>
<span class="token comment">##   supervised auto    - detect upstart or systemd method based on</span>
<span class="token comment">##                        UPSTART_JOB or NOTIFY_SOCKET environment variables</span>
<span class="token comment">## Note: these supervision methods only signal &quot;process is ready.&quot;</span>
<span class="token comment">##       They do not enable continuous liveness pings back to your supervisor.</span>
supervised no

<span class="token comment">## If a pid file is specified, Redis writes it where specified at startup</span>
<span class="token comment">## and removes it at exit.</span>
<span class="token comment">##</span>
<span class="token comment">## When the server runs non daemonized, no pid file is created if none is</span>
<span class="token comment">## specified in the configuration. When the server is daemonized, the pid file</span>
<span class="token comment">## is used even if not specified, defaulting to &quot;/var/run/redis.pid&quot;.</span>
<span class="token comment">##</span>
<span class="token comment">## Creating a pid file is best effort: if Redis is not able to create it</span>
<span class="token comment">## nothing bad happens, the server will start and run normally.</span>
pidfile /var/run/redis_6391.pid

<span class="token comment">## Specify the server verbosity level.</span>
<span class="token comment">## This can be one of:</span>
<span class="token comment">## debug (a lot of information, useful for development/testing)</span>
<span class="token comment">## verbose (many rarely useful info, but not a mess like the debug level)</span>
<span class="token comment">## notice (moderately verbose, what you want in production probably)</span>
<span class="token comment">## warning (only very important / critical messages are logged)</span>
loglevel notice

<span class="token comment">## Specify the log file name. Also the empty string can be used to force</span>
<span class="token comment">## Redis to log on the standard output. Note that if you use standard</span>
<span class="token comment">## output for logging but daemonize, logs will be sent to /dev/null</span>
logfile &quot;&quot;

<span class="token comment">## To enable logging to the system logger, just set 'syslog-enabled' to yes,</span>
<span class="token comment">## and optionally update the other syslog parameters to suit your needs.</span>
<span class="token comment">## syslog-enabled no</span>

<span class="token comment">## Specify the syslog identity.</span>
<span class="token comment">## syslog-ident redis</span>

<span class="token comment">## Specify the syslog facility. Must be USER or between LOCAL0-LOCAL7.</span>
<span class="token comment">## syslog-facility local0</span>

<span class="token comment">## Set the number of databases. The default database is DB 0, you can select</span>
<span class="token comment">## a different one on a per-connection basis using SELECT &lt;dbid&gt; where</span>
<span class="token comment">## dbid is a number between 0 and 'databases'-1</span>
databases 16

<span class="token comment">## By default Redis shows an ASCII art logo only when started to log to the</span>
<span class="token comment">## standard output and if the standard output is a TTY. Basically this means</span>
<span class="token comment">## that normally a logo is displayed only in interactive sessions.</span>
<span class="token comment">##</span>
<span class="token comment">## However it is possible to force the pre-4.0 behavior and always show a</span>
<span class="token comment">## ASCII art logo in startup logs by setting the following option to yes.</span>
always-show-logo yes

<span class="token comment">################################ SNAPSHOTTING  ################################</span>
<span class="token comment">##</span>
<span class="token comment">## Save the DB on disk:</span>
<span class="token comment">##</span>
<span class="token comment">##   save &lt;seconds&gt; &lt;changes&gt;</span>
<span class="token comment">##</span>
<span class="token comment">##   Will save the DB if both the given number of seconds and the given</span>
<span class="token comment">##   number of write operations against the DB occurred.</span>
<span class="token comment">##</span>
<span class="token comment">##   In the example below the behaviour will be to save:</span>
<span class="token comment">##   after 900 sec (15 min) if at least 1 key changed</span>
<span class="token comment">##   after 300 sec (5 min) if at least 10 keys changed</span>
<span class="token comment">##   after 60 sec if at least 10000 keys changed</span>
<span class="token comment">##</span>
<span class="token comment">##   Note: you can disable saving completely by commenting out all &quot;save&quot; lines.</span>
<span class="token comment">##</span>
<span class="token comment">##   It is also possible to remove all the previously configured save</span>
<span class="token comment">##   points by adding a save directive with a single empty string argument</span>
<span class="token comment">##   like in the following example:</span>
<span class="token comment">##</span>
<span class="token comment">##   save &quot;&quot;</span>

save 900 1
save 300 10
save 60 10000

<span class="token comment">## By default Redis will stop accepting writes if RDB snapshots are enabled</span>
<span class="token comment">## (at least one save point) and the latest background save failed.</span>
<span class="token comment">## This will make the user aware (in a hard way) that data is not persisting</span>
<span class="token comment">## on disk properly, otherwise chances are that no one will notice and some</span>
<span class="token comment">## disaster will happen.</span>
<span class="token comment">##</span>
<span class="token comment">## If the background saving process will start working again Redis will</span>
<span class="token comment">## automatically allow writes again.</span>
<span class="token comment">##</span>
<span class="token comment">## However if you have setup your proper monitoring of the Redis server</span>
<span class="token comment">## and persistence, you may want to disable this feature so that Redis will</span>
<span class="token comment">## continue to work as usual even if there are problems with disk,</span>
<span class="token comment">## permissions, and so forth.</span>
stop-writes-on-bgsave-error yes

<span class="token comment">## Compress string objects using LZF when dump .rdb databases?</span>
<span class="token comment">## For default that's set to 'yes' as it's almost always a win.</span>
<span class="token comment">## If you want to save some CPU in the saving child set it to 'no' but</span>
<span class="token comment">## the dataset will likely be bigger if you have compressible values or keys.</span>
rdbcompression yes

<span class="token comment">## Since version 5 of RDB a CRC64 checksum is placed at the end of the file.</span>
<span class="token comment">## This makes the format more resistant to corruption but there is a performance</span>
<span class="token comment">## hit to pay (around 10%) when saving and loading RDB files, so you can disable it</span>
<span class="token comment">## for maximum performances.</span>
<span class="token comment">##</span>
<span class="token comment">## RDB files created with checksum disabled have a checksum of zero that will</span>
<span class="token comment">## tell the loading code to skip the check.</span>
rdbchecksum yes

<span class="token comment">## The filename where to dump the DB</span>
dbfilename dump.rdb

<span class="token comment">## The working directory.</span>
<span class="token comment">##</span>
<span class="token comment">## The DB will be written inside this directory, with the filename specified</span>
<span class="token comment">## above using the 'dbfilename' configuration directive.</span>
<span class="token comment">##</span>
<span class="token comment">## The Append Only File will also be created inside this directory.</span>
<span class="token comment">##</span>
<span class="token comment">## Note that you must specify a directory here, not a file name.</span>
dir &quot;/data&quot;

<span class="token comment">################################# REPLICATION #################################</span>

<span class="token comment">## Master-Replica replication. Use replicaof to make a Redis instance a copy of</span>
<span class="token comment">## another Redis server. A few things to understand ASAP about Redis replication.</span>
<span class="token comment">##</span>
<span class="token comment">##   +------------------+      +---------------+</span>
<span class="token comment">##   |      Master      | ---&gt; |    Replica    |</span>
<span class="token comment">##   | (receive writes) |      |  (exact copy) |</span>
<span class="token comment">##   +------------------+      +---------------+</span>
<span class="token comment">##</span>
<span class="token comment">## 1) Redis replication is asynchronous, but you can configure a master to</span>
<span class="token comment">##    stop accepting writes if it appears to be not connected with at least</span>
<span class="token comment">##    a given number of replicas.</span>
<span class="token comment">## 2) Redis replicas are able to perform a partial resynchronization with the</span>
<span class="token comment">##    master if the replication link is lost for a relatively small amount of</span>
<span class="token comment">##    time. You may want to configure the replication backlog size (see the next</span>
<span class="token comment">##    sections of this file) with a sensible value depending on your needs.</span>
<span class="token comment">## 3) Replication is automatic and does not need user intervention. After a</span>
<span class="token comment">##    network partition replicas automatically try to reconnect to masters</span>
<span class="token comment">##    and resynchronize with them.</span>
<span class="token comment">##</span>
<span class="token comment">## replicaof &lt;masterip&gt; &lt;masterport&gt;</span>

<span class="token comment">## If the master is password protected (using the &quot;requirepass&quot; configuration</span>
<span class="token comment">## directive below) it is possible to tell the replica to authenticate before</span>
<span class="token comment">## starting the replication synchronization process, otherwise the master will</span>
<span class="token comment">## refuse the replica request.</span>
<span class="token comment">##</span>
masterauth 123456

<span class="token comment">## When a replica loses its connection with the master, or when the replication</span>
<span class="token comment">## is still in progress, the replica can act in two different ways:</span>
<span class="token comment">## and to allocate it in a better place), and at the same time, will release the</span>
<span class="token comment">## old copies of the data. This process, repeated incrementally for all the keys</span>
<span class="token comment">## will cause the fragmentation to drop back to normal values.</span>
<span class="token comment">##</span>
<span class="token comment">## Important things to understand:</span>
<span class="token comment">##</span>
<span class="token comment">## 1. This feature is disabled by default, and only works if you compiled Redis</span>
<span class="token comment">##    to use the copy of Jemalloc we ship with the source code of Redis.</span>
<span class="token comment">##    This is the default with Linux builds.</span>
<span class="token comment">##</span>
<span class="token comment">## 2. You never need to enable this feature if you don't have fragmentation</span>
<span class="token comment">##    issues.</span>
<span class="token comment">##</span>
<span class="token comment">## 3. Once you experience fragmentation, you can enable this feature when</span>
<span class="token comment">##    needed with the command &quot;CONFIG SET activedefrag yes&quot;.</span>
<span class="token comment">##</span>
<span class="token comment">## The configuration parameters are able to fine tune the behavior of the</span>
<span class="token comment">## defragmentation process. If you are not sure about what they mean it is</span>
<span class="token comment">## a good idea to leave the defaults untouched.</span>

<span class="token comment">## Enabled active defragmentation</span>
<span class="token comment">## activedefrag yes</span>

<span class="token comment">## Minimum amount of fragmentation waste to start active defrag</span>
<span class="token comment">## active-defrag-ignore-bytes 100mb</span>

<span class="token comment">## Minimum percentage of fragmentation to start active defrag</span>
<span class="token comment">## active-defrag-threshold-lower 10</span>

<span class="token comment">## Maximum percentage of fragmentation at which we use maximum effort</span>
<span class="token comment">## active-defrag-threshold-upper 100</span>

<span class="token comment">## Minimal effort for defrag in CPU percentage</span>
<span class="token comment">## active-defrag-cycle-min 5</span>

<span class="token comment">## Maximal effort for defrag in CPU percentage</span>
<span class="token comment">## active-defrag-cycle-max 75</span>

<span class="token comment">## Maximum number of set/hash/zset/list fields that will be processed from</span>
<span class="token comment">## the main dictionary scan</span>
<span class="token comment">## active-defrag-max-scan-fields 1000</span>
</code></pre></div><h2 id="redis-sh"><a href="#redis-sh" class="header-anchor">#</a> redis.sh</h2> <div class="language-shell script extra-class"><pre class="language-shell"><code>redis-server  /config/nodes-<span class="token variable">${PORT}</span>.conf
</code></pre></div><h2 id="yml"><a href="#yml" class="header-anchor">#</a> yml</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
    <span class="token key atrule">network_mode</span><span class="token punctuation">:</span> host <span class="token comment">## 使用host模式</span>
    <span class="token key atrule">privileged</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">## 拥有容器内命令执行的权限</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /usr/local/src/docker/redis<span class="token punctuation">-</span>cluster/config<span class="token punctuation">:</span>/config <span class="token comment">##配置文件目录映射到宿主机</span>
    <span class="token key atrule">entrypoint</span><span class="token punctuation">:</span> <span class="token comment">## 设置服务默认的启动程序</span>
      <span class="token punctuation">-</span> /bin/bash
      <span class="token punctuation">-</span> redis.sh
  <span class="token key atrule">redis-master2</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span><span class="token number">5.0</span>
    <span class="token key atrule">working_dir</span><span class="token punctuation">:</span> /config
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> node2
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> PORT=6392
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 6392<span class="token punctuation">:</span><span class="token number">6392</span>
      <span class="token punctuation">-</span> 16392<span class="token punctuation">:</span><span class="token number">16392</span>
    <span class="token key atrule">stdin_open</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">network_mode</span><span class="token punctuation">:</span> host
    <span class="token key atrule">tty</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">privileged</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /usr/local/src/docker/redis<span class="token punctuation">-</span>cluster/config<span class="token punctuation">:</span>/config
    <span class="token key atrule">entrypoint</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /bin/bash
      <span class="token punctuation">-</span> redis.sh
  <span class="token key atrule">redis-master3</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span><span class="token number">5.0</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> node3
    <span class="token key atrule">working_dir</span><span class="token punctuation">:</span> /config
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> PORT=6393
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 6393<span class="token punctuation">:</span><span class="token number">6393</span>
      <span class="token punctuation">-</span> 16393<span class="token punctuation">:</span><span class="token number">16393</span>
    <span class="token key atrule">stdin_open</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">network_mode</span><span class="token punctuation">:</span> host
    <span class="token key atrule">tty</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">privileged</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /usr/local/src/docker/redis<span class="token punctuation">-</span>cluster/config<span class="token punctuation">:</span>/config
    <span class="token key atrule">entrypoint</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /bin/bash
      <span class="token punctuation">-</span> redis.sh
</code></pre></div><h2 id="集群的创建"><a href="#集群的创建" class="header-anchor">#</a> 集群的创建</h2> <ul><li>需要在容器里面执行 一条创建集群的语句</li> <li>关于建立集群的说明 <a href="https://www.cnblogs.com/zhoujinyi/p/11606935.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/zhoujinyi/p/11606935.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-shell script extra-class"><pre class="language-shell"><code>redis-cli --cluster add-node <span class="token number">192.168</span>.163.132:6382 <span class="token number">192.168</span>.163.132:6379 --cluster-slave --cluster-master-id 117457eab5071954faab5e81c3170600d5192270

</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后编辑时间:</span> <span class="time">12/21/2020, 8:56:16 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/curiousness/redis配置及命令大全.html" class="prev">
        redis配置及命令大全
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.27b2d4ce.js" defer></script><script src="/assets/js/4.9a9f6078.js" defer></script><script src="/assets/js/54.2c4f1849.js" defer></script>
  </body>
</html>
